<html>
<head>
    <meta charset="utf-8"/>
    <style type="text/css">
        p.para {
            text-align: center;    
        }
    </style>
    <script type="text/javascript">
    var xmlDoc;
    function loadXML(url){    
        if(window.XMLHttpRequest){
            xmlhttp=new XMLHttpRequest();
        }
        else{
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.open("GET",url,false); //open send response    
        xmlhttp.send();
        xmlDoc=xmlhttp.responseXML;
         if(xmlhttp.status==404) 
         {
             alert("File does not exist"); 
             return false;
         }
          
        return xmlDoc;
    }
    function getURL(url){
    //var url= document.getElementById("txtUrl").value
    if(url==""){
        window.alert("Please enter the URL of the XML file in the textbox!");
    }else{
        xmlDoc=loadXML(url);
        if(xmlDoc.documentElement.nodeName=="parsererror"){
            alert("Error in xml file\n");        
        }else if(xmlDoc==false){
            return;
        }else{
            //console.log("inside");
            var data=xmlDoc.getElementsByTagName("Header")[0].getElementsByTagName("Data");
            var row=xmlDoc.getElementsByTagName("Row");
            if(row.length==0){
                alert("Empty network list");
                return;
            }
            var xmlWin=window.open("","_blank","height=400,width=800,scrollbars=yes");
            xmlWin.document.write("<table border='1'><tr>");  
            for(var i=0;i<data.length;i++){
                var header=data[i].childNodes[0].nodeValue;
                xmlWin.document.write('<th>'+header+'</th>');   
            }
            xmlWin.document.write('</tr>');       
            for(var j=0;j<row.length;j++){
                var row_child_num=row[j].childNodes.length;
                console.log(j+"st row");
                console.log("No of childs:"+row_child_num);
                xmlWin.document.write('<tr>');
                for(var i=0;i<row_child_num;i++){
                    console.log("On child no "+i);
                    console.log("Checking no of children of child no "+i);
                    var row_c_c_num=row[j].childNodes[i].childNodes.length;
                    console.log("Nodetype of child "+i+"th of row "+j+":"+row[j].childNodes[i].nodeType);
                    if(row_c_c_num>1 && row[j].childNodes[i].nodeType==1){
                        xmlWin.document.write('<td><ul>');
                        for(var k=0;k<row_c_c_num;k++){
                            if(row[j].childNodes[i].childNodes[k].nodeType==1){
                                console.log("Nodetype of feeds "+k+"th child:"+row[j].childNodes[i].childNodes[k].nodeType);
                            if(typeof(row[j].childNodes[i].childNodes[k].childNodes[0])!= "undefined"){
                                var temp=row[j].childNodes[i].childNodes[k].childNodes[0].nodeValue;
                                console.log("On feeds:["+k+"]"+temp);
                                temp=temp.trim();
                                    if(temp!=""){
                                        xmlWin.document.write('<li>'+row[j].childNodes[i].childNodes[k].childNodes[0].nodeValue+'</li>');
                                    }
                                }
                            }
                        }
                               
                    
                        xmlWin.document.write('</ul></td>');
                    }else if(i==4 && row[j].childNodes[i].nodeType==1){  //HomePage
                        xmlWin.document.write('<td>');    
                    if(typeof(row[j].childNodes[i].childNodes[0])!= "undefined"){      
                         temp_g=row[j].childNodes[i].childNodes[0].nodeValue;
                         temp_g=temp_g.trim();
                         if(temp_g!="")  
                             xmlWin.document.write('<a href='+row[j].childNodes[i].childNodes[0].nodeValue+'>'+row[j].childNodes[i].childNodes[0].nodeValue+'</a>'); 
                        }
                        xmlWin.document.write('</td>');
                    }else if(i==5 && row[j].childNodes[i].nodeType==1){
                        //logo
                        console.log("INSIDE i=5");
                        xmlWin.document.write('<td>');
                        console.log("STARTED A <TD> AND CHECKING FOR UNDEFINED");
                        if(typeof(row[j].childNodes[i].childNodes[0])!= "undefined"){ 
                            console.log("INSIDE IF");
                            temp_g=row[j].childNodes[i].childNodes[0].nodeValue;
                            temp_g=temp_g.trim();
                            console.log("inside first if");
                            if(temp_g!=""){
                                console.log("NOT BLANK");
                                console.log("Inside 2nd if");
                                xmlWin.document.write('<img src='+row[j].childNodes[i].childNodes[0].nodeValue+'>');
                             }
                        }
                        xmlWin.document.write('</td>');
                    }else{
                        if(row[j].childNodes[i].nodeType==1){
                            xmlWin.document.write('<td>');
                            if(typeof(row[j].childNodes[i].childNodes[0])!= "undefined"){ 
                                temp_g=row[j].childNodes[i].childNodes[0].nodeValue;
                                temp_g=temp_g.trim();//replace('/^\>\s+\<$/',"");
                                if(temp_g!=""){
                                    var abc=row[j].childNodes[i].childNodes[0].nodeValue;
                                    xmlWin.document.write(abc);
                                }
                            }
                            xmlWin.document.write('</td>');
                        }
                    }      
                }
                xmlWin.document.write('</tr>');
            }
                
//            xmlhttp.status(
//            window.open();
//            document.getElementById("p1").innerHTML()=xmlDoc;   
        }
    }
    }
    </script>
</head>
<body>
<form>
<p class="para">
 Enter URL for Company List XML File <br><br>
 <input type="text" id="txtUrl"> <br><br>

 <input type="button" value="Submit Query" name="btnURL"  onclick="getURL(document.getElementById('txtUrl').value)">
</p>
    
</form>
    <noscript/>
</body>
</html>
